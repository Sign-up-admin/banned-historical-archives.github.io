# æµ‹è¯•å·¥ç¨‹é—®é¢˜åˆ†æä¸æ”¹è¿›æ–¹æ¡ˆ / Testing Engineering Issues Analysis and Improvement Plan

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†å½“å‰æµ‹è¯•å·¥ç¨‹å­˜åœ¨çš„é—®é¢˜ã€å½±å“åˆ†æå’Œæ”¹è¿›æ–¹æ¡ˆã€‚

This document details the current issues in testing engineering, impact analysis, and improvement plans.

## ğŸ“‹ ç›®å½• / Table of Contents

- [ğŸ” é—®é¢˜æ¦‚è¿° / Issue Overview](#-é—®é¢˜æ¦‚è¿°--issue-overview)
- [ğŸ“Š è¯¦ç»†é—®é¢˜åˆ†æ / Detailed Issue Analysis](#-è¯¦ç»†é—®é¢˜åˆ†æ--detailed-issue-analysis)
- [ğŸ¯ æ”¹è¿›æ–¹æ¡ˆ / Improvement Solutions](#-æ”¹è¿›æ–¹æ¡ˆ--improvement-solutions)
- [ğŸ“… å®æ–½è®¡åˆ’ / Implementation Plan](#-å®æ–½è®¡åˆ’--implementation-plan)
- [âœ… æ”¹è¿›æ£€æŸ¥æ¸…å• / Improvement Checklist](#-æ”¹è¿›æ£€æŸ¥æ¸…å•--improvement-checklist)

## ğŸ” é—®é¢˜æ¦‚è¿° / Issue Overview

### å½“å‰æµ‹è¯•å·¥ç¨‹çŠ¶æ€ / Current Testing Engineering Status

**æµ‹è¯•ç»Ÿè®¡ / Test Statistics:**
- æµ‹è¯•æ–‡ä»¶æ•°é‡: 2 ä¸ª
- é€šè¿‡æµ‹è¯•: 6 ä¸ª
- è·³è¿‡æµ‹è¯•: 1 ä¸ª
- React ç»„ä»¶æ–‡ä»¶: 16 ä¸ªï¼ˆ0 ä¸ªæµ‹è¯•ï¼‰
- å·¥å…·å‡½æ•°: 12 ä¸ªå¯¼å‡ºå‡½æ•°ï¼ˆéƒ¨åˆ†æµ‹è¯•ï¼‰
- æ•´ä½“æµ‹è¯•è¦†ç›–ç‡: ~5%

**å…³é”®é—®é¢˜ / Key Issues:**
1. âŒ æµ‹è¯•è¦†ç›–ç‡ä¸¥é‡ä¸è¶³
2. âš ï¸ ç‰ˆæœ¬å’ŒæŠ€æœ¯æ ˆè½å
3. âŒ æµ‹è¯•ç±»å‹ä¸å®Œæ•´
4. âŒ CI/CD é›†æˆç¼ºå¤±
5. âš ï¸ æµ‹è¯•è´¨é‡å’Œç»´æŠ¤æ€§é—®é¢˜
6. âš ï¸ é…ç½®å’Œå·¥å…·é“¾ä¸å®Œæ•´
7. âš ï¸ æ¶æ„å’Œç»„ç»‡é—®é¢˜

## ğŸ“Š è¯¦ç»†é—®é¢˜åˆ†æ / Detailed Issue Analysis

### 1. æµ‹è¯•è¦†ç›–ç‡ä¸¥é‡ä¸è¶³ / Severely Insufficient Test Coverage

#### é—®é¢˜æè¿° / Problem Description

**ç°çŠ¶ / Current Status:**
- ä»…æœ‰ 2 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼š`test/utils.test.ts` å’Œ `test/create-ocr-issue.test.ts`
- 6 ä¸ªæµ‹è¯•ç”¨ä¾‹é€šè¿‡ï¼Œ1 ä¸ªè¢«è·³è¿‡
- 16 ä¸ª React ç»„ä»¶æ–‡ä»¶å®Œå…¨æ²¡æœ‰æµ‹è¯•è¦†ç›–
- `utils/index.ts` ä¸­æœ‰ 12 ä¸ªå¯¼å‡ºå‡½æ•°ï¼Œä½†æµ‹è¯•è¦†ç›–å¾ˆå°‘
- å¤§é‡æºä»£ç æ–‡ä»¶å®Œå…¨æ²¡æœ‰æµ‹è¯•

**å…·ä½“æ•°æ® / Specific Data:**
```
æµ‹è¯•æ–‡ä»¶:
  - test/utils.test.ts: 6 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆapply_patch_v2 ç›¸å…³ï¼‰
  - test/create-ocr-issue.test.ts: 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆè¢«è·³è¿‡ï¼‰

æœªæµ‹è¯•çš„ç»„ä»¶:
  - components/Article/index.tsx
  - components/Article/PatchableArticle/index.tsx
  - components/Article/PatchableArticle/PartEditor.tsx
  - components/Article/PatchableArticle/CommentEditor.tsx
  - components/Authors.tsx
  - components/DiffViewer.tsx
  - components/Footer.tsx
  - components/ImageTags.tsx
  - components/Layout.tsx
  - components/Loading.tsx
  - components/Navbar.tsx
  - components/Tags.tsx
  - components/useAuthorFilterDialog.tsx
  - components/useDateFilterDialog.tsx
  - components/useSourceFilterDialog.tsx
  - components/useTagFilterDialog.tsx
```

#### å½±å“åˆ†æ / Impact Analysis

**é£é™© / Risks:**
- ğŸ”´ **é«˜**: æ— æ³•æœ‰æ•ˆä¿éšœä»£ç è´¨é‡ï¼Œæ½œåœ¨ bug éš¾ä»¥å‘ç°
- ğŸ”´ **é«˜**: é‡æ„é£é™©æé«˜ï¼Œç¼ºä¹å›å½’æµ‹è¯•ä¿éšœ
- ğŸŸ¡ **ä¸­**: æ–°åŠŸèƒ½å¼€å‘ç¼ºä¹æµ‹è¯•æŒ‡å¯¼
- ğŸŸ¡ **ä¸­**: ä»£ç å®¡æŸ¥æ— æ³•éªŒè¯åŠŸèƒ½æ­£ç¡®æ€§

**ä¸šåŠ¡å½±å“ / Business Impact:**
- ç”Ÿäº§ç¯å¢ƒå¯èƒ½å‡ºç°æœªå‘ç°çš„ bug
- ä»£ç å˜æ›´å¯èƒ½å¯¼è‡´åŠŸèƒ½å›å½’
- å¼€å‘æ•ˆç‡é™ä½ï¼ˆæ‰‹åŠ¨æµ‹è¯•æˆæœ¬é«˜ï¼‰
- æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**çŸ­æœŸç›®æ ‡ï¼ˆ1-3ä¸ªæœˆï¼‰:**
1. ä¸º `utils/index.ts` ä¸­æ‰€æœ‰å‡½æ•°ç¼–å†™å®Œæ•´æµ‹è¯•
   - ç›®æ ‡è¦†ç›–ç‡: >= 80%
   - åŒ…å«è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†æµ‹è¯•

2. é€‰æ‹© 3-5 ä¸ªæ ¸å¿ƒç»„ä»¶å¼€å§‹æµ‹è¯•
   - ä¼˜å…ˆ: Article, Layout, Navbar
   - å»ºç«‹ç»„ä»¶æµ‹è¯•æ¨¡æ¿

**ä¸­æœŸç›®æ ‡ï¼ˆ3-6ä¸ªæœˆï¼‰:**
1. ä¸ºæ‰€æœ‰ 16 ä¸ª React ç»„ä»¶ç¼–å†™æµ‹è¯•
   - ç›®æ ‡è¦†ç›–ç‡: >= 70%
   - ä½¿ç”¨ React Testing Library

2. ä¸ºå…³é”®ä¸šåŠ¡é€»è¾‘æ·»åŠ æµ‹è¯•
   - æ•°æ®å¤„ç†æµç¨‹
   - æœç´¢åŠŸèƒ½
   - æ•°æ®åŠ è½½

**é•¿æœŸç›®æ ‡ï¼ˆ6-12ä¸ªæœˆï¼‰:**
1. æ•´ä½“é¡¹ç›®è¦†ç›–ç‡ >= 60%
2. å»ºç«‹å®Œæ•´çš„æµ‹è¯•ä½“ç³»

---

### 2. ç‰ˆæœ¬å’ŒæŠ€æœ¯æ ˆè½å / Outdated Versions and Tech Stack

#### é—®é¢˜æè¿° / Problem Description

**Vitest ç‰ˆæœ¬é—®é¢˜ / Vitest Version Issue:**
- **å½“å‰ç‰ˆæœ¬**: 0.19.1ï¼ˆå‘å¸ƒäº 2023 å¹´ï¼‰
- **æœ€æ–°ç‰ˆæœ¬**: 4.0+ï¼ˆ2024 å¹´ï¼‰
- **é—®é¢˜**: 0.19.1 ä¸æ”¯æŒå†…ç½®è¦†ç›–ç‡åŠŸèƒ½
- **å½±å“**: `vitest.config.ts` ä¸­è¦†ç›–ç‡é…ç½®è¢«æ³¨é‡Šï¼Œæ— æ³•ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š

**ä¾èµ–ç¼ºå¤± / Missing Dependencies:**
- âŒ ç¼ºå°‘ `@testing-library/react`ï¼ˆReact ç»„ä»¶æµ‹è¯•å¿…éœ€ï¼‰
- âŒ ç¼ºå°‘ `@testing-library/jest-dom`ï¼ˆDOM æ–­è¨€æ‰©å±•ï¼‰
- **å½±å“**: æ— æ³•è¿›è¡Œ React ç»„ä»¶æµ‹è¯•

#### å½±å“åˆ†æ / Impact Analysis

**æŠ€æœ¯å½±å“ / Technical Impact:**
- ğŸ”´ **é˜»å¡**: æ— æ³•ä½¿ç”¨è¦†ç›–ç‡åŠŸèƒ½ï¼Œæ— æ³•è¯„ä¼°æµ‹è¯•è´¨é‡
- ğŸ”´ **é˜»å¡**: æ— æ³•è¿›è¡Œ React ç»„ä»¶æµ‹è¯•
- ğŸŸ¡ **ä¸­**: ç¼ºå°‘ç°ä»£åŒ–çš„æµ‹è¯•å·¥å…·å’ŒåŠŸèƒ½
- ğŸŸ¡ **ä¸­**: å¯èƒ½é”™è¿‡æ€§èƒ½ä¼˜åŒ–å’Œ bug ä¿®å¤

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**ç«‹å³è¡ŒåŠ¨ / Immediate Action:**

1. **å‡çº§ Vitest**
   ```bash
   npm install -D vitest@^4.0.0 @vitest/coverage-v8@^4.0.0
   ```

2. **å®‰è£… React æµ‹è¯•ä¾èµ–**
   ```bash
   npm install -D @testing-library/react @testing-library/jest-dom
   ```

3. **æ›´æ–°é…ç½®æ–‡ä»¶**
   - å¯ç”¨ `vitest.config.ts` ä¸­çš„è¦†ç›–ç‡é…ç½®
   - æ›´æ–° `test/setup.ts` å¼•å…¥ `@testing-library/jest-dom`
   - æ›´æ–° `package.json` ä¸­çš„ `test:coverage` è„šæœ¬

4. **éªŒè¯å‡çº§**
   - è¿è¡Œæ‰€æœ‰ç°æœ‰æµ‹è¯•ç¡®ä¿å…¼å®¹æ€§
   - æµ‹è¯•è¦†ç›–ç‡åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ

---

### 3. æµ‹è¯•ç±»å‹ä¸å®Œæ•´ / Incomplete Test Types

#### é—®é¢˜æè¿° / Problem Description

**å½“å‰æµ‹è¯•ç±»å‹åˆ†å¸ƒ / Current Test Type Distribution:**
- âœ… **å•å…ƒæµ‹è¯•ï¼ˆéƒ¨åˆ†ï¼‰**: `utils` å‡½æ•°æµ‹è¯•å­˜åœ¨ä½†ä¸å®Œæ•´
- âŒ **React ç»„ä»¶æµ‹è¯•**: å®Œå…¨ç¼ºå¤±ï¼ˆ16 ä¸ªç»„ä»¶æ–‡ä»¶ï¼‰
- âŒ **é›†æˆæµ‹è¯•**: åªæœ‰ 1 ä¸ªè¢«è·³è¿‡çš„ OCR é›†æˆæµ‹è¯•
- âŒ **ç«¯åˆ°ç«¯æµ‹è¯•**: å®Œå…¨ç¼ºå¤±

**æµ‹è¯•é‡‘å­—å¡”å¤±è¡¡ / Test Pyramid Imbalance:**
```
ç†æƒ³çŠ¶æ€:         å½“å‰çŠ¶æ€:
    /\
   /E2E\          âŒ ç¼ºå¤±
  /-----\
 /Integration\    âš ï¸  1ä¸ªè·³è¿‡
/-------------\
/   Unit Tests  \  âš ï¸  éƒ¨åˆ†
/-----------------\
```

#### å½±å“åˆ†æ / Impact Analysis

**æµ‹è¯•ç›²åŒº / Test Blind Spots:**
- ğŸ”´ **é«˜**: ç»„ä»¶äº¤äº’å’Œ UI é€»è¾‘æ— æ³•éªŒè¯
- ğŸ”´ **é«˜**: ç³»ç»Ÿé›†æˆæµç¨‹æ— æ³•æµ‹è¯•
- ğŸŸ¡ **ä¸­**: ç”¨æˆ·ç«¯åˆ°ç«¯æµç¨‹æ— æ³•ä¿éšœ
- ğŸŸ¡ **ä¸­**: è·¨æ¨¡å—åŠŸèƒ½æ— æ³•éªŒè¯

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**ä¼˜å…ˆçº§æ’åº / Priority Order:**

1. **å•å…ƒæµ‹è¯•å®Œå–„**ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
   - å®Œæˆ `utils/index.ts` æ‰€æœ‰å‡½æ•°æµ‹è¯•
   - è¡¥å……è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†

2. **ç»„ä»¶æµ‹è¯•**ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
   - å®‰è£… React Testing Library
   - ä»æ ¸å¿ƒç»„ä»¶å¼€å§‹ï¼ˆArticle, Layoutï¼‰
   - é€æ­¥æ‰©å±•åˆ°æ‰€æœ‰ç»„ä»¶

3. **é›†æˆæµ‹è¯•**ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
   - ä¸º OCR å·¥ä½œæµæ·»åŠ  mock æµ‹è¯•
   - ä¸ºæ•°æ®åŠ è½½æµç¨‹æ·»åŠ æµ‹è¯•
   - ä¸ºæœç´¢åŠŸèƒ½æ·»åŠ æµ‹è¯•

4. **E2E æµ‹è¯•**ï¼ˆä½ä¼˜å…ˆçº§ï¼Œé•¿æœŸï¼‰
   - å¼•å…¥ Playwright æˆ– Cypress
   - ä¸ºä¸»è¦ç”¨æˆ·æµç¨‹ç¼–å†™æµ‹è¯•

---

### 4. CI/CD é›†æˆç¼ºå¤± / Missing CI/CD Integration

#### é—®é¢˜æè¿° / Problem Description

**å½“å‰ CI/CD çŠ¶æ€ / Current CI/CD Status:**
- âœ… æœ‰å¤šä¸ª GitHub workflowsï¼ˆ`.github/workflows/`ï¼‰
- âŒ æ²¡æœ‰æµ‹è¯•ç›¸å…³çš„ workflow
- âŒ æ²¡æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•è¿è¡Œ
- âŒ æ²¡æœ‰æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ
- âŒ æ²¡æœ‰è¦†ç›–ç‡æ£€æŸ¥

**ç°æœ‰ Workflows:**
- `automated_entry.yml` - OCR è‡ªåŠ¨åŒ–å½•å…¥
- `build-docker-image.yml` - Docker é•œåƒæ„å»º
- `build-frontend.yml` - å‰ç«¯æ„å»º
- `build-json.yml` - JSON æ•°æ®æ„å»º
- `build-txt.yml` - æ–‡æœ¬æ•°æ®æ„å»º
- `build.yml` - ä¸»æ„å»ºæµç¨‹
- `docs-check.yml` - æ–‡æ¡£æ£€æŸ¥
- `generate-docs.yml` - æ–‡æ¡£ç”Ÿæˆ
- `patch.yml` - è¡¥ä¸å¤„ç†

**ç¼ºå¤±çš„ Workflow:**
- âŒ `test.yml` - æµ‹è¯•è¿è¡Œå’ŒæŠ¥å‘Š

#### å½±å“åˆ†æ / Impact Analysis

**å¼€å‘æµç¨‹å½±å“ / Development Process Impact:**
- ğŸ”´ **é«˜**: PR åˆå¹¶å‰æ— æ³•è‡ªåŠ¨éªŒè¯æµ‹è¯•
- ğŸ”´ **é«˜**: æ— æ³•åŠæ—¶å‘ç°æµ‹è¯•å¤±è´¥
- ğŸŸ¡ **ä¸­**: æµ‹è¯•è¦†ç›–ç‡æ— æ³•ç›‘æ§
- ğŸŸ¡ **ä¸­**: æµ‹è¯•æŠ¥å‘Šæ— æ³•è‡ªåŠ¨ç”Ÿæˆå’Œåˆ†äº«

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**åˆ›å»ºæµ‹è¯• Workflow / Create Test Workflow:**

åˆ›å»º `.github/workflows/test.yml`:

```yaml
name: Tests

on:
  push:
    branches: [master]
  pull_request:
    branches: [master]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm test
        
      - name: Generate coverage report
        run: npm run test:coverage
        
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/coverage-final.json
```

**é›†æˆåˆ°ç°æœ‰æµç¨‹ / Integration:**
- åœ¨ `build.yml` ä¸­æ·»åŠ æµ‹è¯•æ­¥éª¤
- åœ¨ PR æ£€æŸ¥ä¸­è¦æ±‚æµ‹è¯•é€šè¿‡
- è®¾ç½®è¦†ç›–ç‡é˜ˆå€¼æ£€æŸ¥

---

### 5. æµ‹è¯•è´¨é‡å’Œç»´æŠ¤æ€§é—®é¢˜ / Test Quality and Maintainability Issues

#### é—®é¢˜æè¿° / Problem Description

**å…·ä½“é—®é¢˜ / Specific Issues:**

1. **è·³è¿‡çš„é‡è¦æµ‹è¯•**
   - `test/create-ocr-issue.test.ts` ä¸­çš„ OCR é›†æˆæµ‹è¯•è¢«è·³è¿‡
   - æ²¡æœ‰ mock æ›¿ä»£æ–¹æ¡ˆ
   - ç¼ºå°‘è¯´æ˜æ–‡æ¡£

2. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•ç¼ºå¤±**
   - ç¼ºå°‘é”™è¯¯å¤„ç†æµ‹è¯•
   - ç¼ºå°‘è¾¹ç•Œå€¼æµ‹è¯•
   - ç¼ºå°‘å¼‚å¸¸æƒ…å†µæµ‹è¯•

3. **å¿«ç…§æµ‹è¯•ç»´æŠ¤**
   - å¿«ç…§æ–‡ä»¶å¯èƒ½è¿‡æœŸ
   - ç¼ºå°‘è‡ªåŠ¨æ›´æ–°æœºåˆ¶
   - ç¼ºå°‘å¿«ç…§å®¡æŸ¥æµç¨‹

4. **æµ‹è¯•ç¨³å®šæ€§**
   - `test/setup.ts` æ–‡ä»¶å­˜åœ¨ä½†ä¸ºç©º
   - ç¼ºå°‘å…¨å±€æµ‹è¯•é…ç½®
   - ç¼ºå°‘æµ‹è¯•æ•°æ®ç®¡ç†

#### å½±å“åˆ†æ / Impact Analysis

**è´¨é‡é£é™© / Quality Risks:**
- ğŸŸ¡ **ä¸­**: æµ‹è¯•å¯èƒ½è¿‡æ—¶æˆ–ä¸å‡†ç¡®
- ğŸŸ¡ **ä¸­**: æµ‹è¯•ç»´æŠ¤æˆæœ¬é«˜
- ğŸŸ¡ **ä¸­**: æµ‹è¯•æ‰§è¡Œä¸ç¨³å®š

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**ç«‹å³æ”¹è¿› / Immediate Improvements:**

1. **å®Œå–„ `test/setup.ts`**
   ```typescript
   import '@testing-library/jest-dom';
   import { vi } from 'vitest';
   
   // å…¨å±€ mock é…ç½®
   global.fetch = vi.fn();
   
   // æµ‹è¯•ç¯å¢ƒå˜é‡
   process.env.NODE_ENV = 'test';
   ```

2. **ä¸ºè·³è¿‡çš„æµ‹è¯•æ·»åŠ  mock**
   - ä¸º OCR é›†æˆæµ‹è¯•åˆ›å»º mock ç‰ˆæœ¬
   - æ·»åŠ æµ‹è¯•è¯´æ˜æ–‡æ¡£

3. **å»ºç«‹æµ‹è¯•æ•°æ®ç®¡ç†**
   - åˆ›å»º `test/fixtures/` ç›®å½•
   - åˆ›å»º `test/mocks/` ç›®å½•
   - å»ºç«‹æµ‹è¯•å·¥å…·å‡½æ•°åº“

4. **å¿«ç…§æµ‹è¯•è§„èŒƒ**
   - å®šæœŸå®¡æŸ¥å¿«ç…§æ–‡ä»¶
   - å»ºç«‹å¿«ç…§æ›´æ–°æµç¨‹
   - æ·»åŠ å¿«ç…§æµ‹è¯•è¯´æ˜

---

### 6. é…ç½®å’Œå·¥å…·é“¾ä¸å®Œæ•´ / Incomplete Configuration and Toolchain

#### é—®é¢˜æè¿° / Problem Description

**é…ç½®é—®é¢˜ / Configuration Issues:**
- `test/setup.ts` æ–‡ä»¶å­˜åœ¨ä½†ä¸ºç©º
- è¦†ç›–ç‡é…ç½®è¢«æ³¨é‡Šï¼ˆç­‰å¾… Vitest å‡çº§ï¼‰
- ç¼ºå°‘æµ‹è¯•ç›¸å…³çš„ TypeScript é…ç½®ä¼˜åŒ–

**å·¥å…·é“¾é—®é¢˜ / Toolchain Issues:**
- è¦†ç›–ç‡è„šæœ¬æ˜¾ç¤ºç‰ˆæœ¬é™åˆ¶ï¼Œä½†æ²¡æœ‰æ›¿ä»£æ–¹æ¡ˆ
- ç¼ºå°‘æµ‹è¯•æŠ¥å‘Šç”Ÿæˆå·¥å…·
- ç¼ºå°‘æµ‹è¯•æ€§èƒ½ç›‘æ§

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**é…ç½®å®Œå–„ / Configuration Enhancement:**

1. **å®Œå–„ `test/setup.ts`**
   - å¼•å…¥æµ‹è¯•åº“æ‰©å±•
   - é…ç½®å…¨å±€ mock
   - è®¾ç½®æµ‹è¯•ç¯å¢ƒå˜é‡

2. **ä¼˜åŒ– TypeScript é…ç½®**
   - æ·»åŠ æµ‹è¯•ç±»å‹å®šä¹‰
   - é…ç½®æµ‹è¯•æ–‡ä»¶è·¯å¾„åˆ«å

3. **å·¥å…·é“¾è¡¥å……**
   - å‡çº§ Vitest åå¯ç”¨è¦†ç›–ç‡
   - é…ç½®æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ
   - æ·»åŠ æµ‹è¯•æ€§èƒ½ç›‘æ§

---

### 7. æ¶æ„å’Œç»„ç»‡é—®é¢˜ / Architecture and Organization Issues

#### é—®é¢˜æè¿° / Problem Description

**æ–‡ä»¶ç»“æ„é—®é¢˜ / File Structure Issues:**
- ç¼ºå°‘ç»„ä»¶æµ‹è¯•ç›®å½•ï¼ˆå¦‚ `test/components/`ï¼‰
- ç¼ºå°‘é›†æˆæµ‹è¯•ç›®å½•ï¼ˆå¦‚ `test/integration/`ï¼‰
- æµ‹è¯•æ–‡ä»¶åˆ†æ•£ï¼Œç¼ºå°‘ç»„ç»‡

**æ•°æ®ç®¡ç†é—®é¢˜ / Data Management Issues:**
- ç¼ºå°‘æµ‹è¯• fixtures ç›®å½•
- ç¼ºå°‘ mock æ•°æ®ç®¡ç†
- æµ‹è¯•æ•°æ®é‡å¤å®šä¹‰

#### æ”¹è¿›æ–¹æ¡ˆ / Improvement Solution

**å»ºç«‹æµ‹è¯•ç›®å½•ç»“æ„ / Establish Test Directory Structure:**

```
test/
â”œâ”€â”€ components/          # React ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ Article.test.tsx
â”‚   â”œâ”€â”€ Layout.test.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ integration/        # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ ocr.test.ts
â”‚   â”œâ”€â”€ search.test.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ fixtures/           # æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ articles.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ mocks/              # Mock æ•°æ®
â”‚   â”œâ”€â”€ api.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/              # æµ‹è¯•å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ test-helpers.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ __snapshots__/      # å¿«ç…§æ–‡ä»¶
â”œâ”€â”€ setup.ts            # æµ‹è¯•è®¾ç½®
â””â”€â”€ utils.test.ts       # å·¥å…·å‡½æ•°æµ‹è¯•
```

---

## ğŸ¯ æ”¹è¿›æ–¹æ¡ˆ / Improvement Solutions

### ä¼˜å…ˆçº§çŸ©é˜µ / Priority Matrix

| é—®é¢˜ | ä¼˜å…ˆçº§ | ç´§æ€¥ç¨‹åº¦ | å·¥ä½œé‡ | é¢„è®¡æ—¶é—´ |
|------|--------|----------|--------|----------|
| å‡çº§ Vitest å’Œå®‰è£…ä¾èµ– | ğŸ”´ é«˜ | ğŸ”´ ç´§æ€¥ | å° | 1-2 å¤© |
| åˆ›å»ºæµ‹è¯• CI/CD | ğŸ”´ é«˜ | ğŸ”´ ç´§æ€¥ | ä¸­ | 2-3 å¤© |
| è¡¥å……æ ¸å¿ƒå‡½æ•°æµ‹è¯• | ğŸ”´ é«˜ | ğŸŸ¡ é‡è¦ | å¤§ | 1-2 å‘¨ |
| å¼€å§‹ç»„ä»¶æµ‹è¯• | ğŸ”´ é«˜ | ğŸŸ¡ é‡è¦ | å¤§ | 2-4 å‘¨ |
| å®Œå–„æµ‹è¯•é…ç½® | ğŸŸ¡ ä¸­ | ğŸŸ¡ é‡è¦ | å° | 3-5 å¤© |
| å»ºç«‹æµ‹è¯•ç›®å½•ç»“æ„ | ğŸŸ¡ ä¸­ | ğŸŸ¢ ä¸€èˆ¬ | å° | 1-2 å¤© |
| é›†æˆæµ‹è¯• | ğŸŸ¢ ä½ | ğŸŸ¢ ä¸€èˆ¬ | ä¸­ | 1-2 å‘¨ |
| E2E æµ‹è¯• | ğŸŸ¢ ä½ | ğŸŸ¢ ä¸€èˆ¬ | å¤§ | 1-2 æœˆ |

### åˆ†é˜¶æ®µå®æ–½è®¡åˆ’ / Phased Implementation Plan

#### ç¬¬ä¸€é˜¶æ®µï¼šç´§æ€¥ä¿®å¤ï¼ˆ1-2å‘¨ï¼‰

**ç›®æ ‡**: è§£å†³é˜»å¡æ€§é—®é¢˜ï¼Œå»ºç«‹åŸºç¡€æµ‹è¯•èƒ½åŠ›

1. **å‡çº§æµ‹è¯•æ¡†æ¶å’Œä¾èµ–**
   - [ ] å‡çº§ Vitest åˆ° 4.0+
   - [ ] å®‰è£… React æµ‹è¯•åº“
   - [ ] æ›´æ–°é…ç½®æ–‡ä»¶
   - [ ] éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡

2. **åˆ›å»ºæµ‹è¯• CI/CD**
   - [ ] åˆ›å»º `.github/workflows/test.yml`
   - [ ] é…ç½®æµ‹è¯•è‡ªåŠ¨è¿è¡Œ
   - [ ] é…ç½®è¦†ç›–ç‡æŠ¥å‘Š
   - [ ] é›†æˆåˆ° PR æ£€æŸ¥

3. **å®Œå–„æµ‹è¯•é…ç½®**
   - [ ] å®Œå–„ `test/setup.ts`
   - [ ] å»ºç«‹æµ‹è¯•ç›®å½•ç»“æ„
   - [ ] åˆ›å»ºæµ‹è¯•å·¥å…·å‡½æ•°

#### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒæµ‹è¯•è¡¥å……ï¼ˆ2-4å‘¨ï¼‰

**ç›®æ ‡**: æé«˜æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•è¦†ç›–ç‡

1. **å·¥å…·å‡½æ•°æµ‹è¯•**
   - [ ] ä¸º `utils/index.ts` æ‰€æœ‰å‡½æ•°ç¼–å†™æµ‹è¯•
   - [ ] æ·»åŠ è¾¹ç•Œæ¡ä»¶æµ‹è¯•
   - [ ] æ·»åŠ é”™è¯¯å¤„ç†æµ‹è¯•
   - [ ] ç›®æ ‡è¦†ç›–ç‡ >= 80%

2. **ç»„ä»¶æµ‹è¯•å¼€å§‹**
   - [ ] é€‰æ‹© 3-5 ä¸ªæ ¸å¿ƒç»„ä»¶
   - [ ] å»ºç«‹ç»„ä»¶æµ‹è¯•æ¨¡æ¿
   - [ ] ç¼–å†™ç»„ä»¶æµ‹è¯•
   - [ ] ç›®æ ‡è¦†ç›–ç‡ >= 50%

#### ç¬¬ä¸‰é˜¶æ®µï¼šå…¨é¢æµ‹è¯•è¦†ç›–ï¼ˆ1-3ä¸ªæœˆï¼‰

**ç›®æ ‡**: å»ºç«‹å®Œæ•´çš„æµ‹è¯•ä½“ç³»

1. **ç»„ä»¶æµ‹è¯•æ‰©å±•**
   - [ ] ä¸ºæ‰€æœ‰ 16 ä¸ªç»„ä»¶ç¼–å†™æµ‹è¯•
   - [ ] ç›®æ ‡è¦†ç›–ç‡ >= 70%

2. **é›†æˆæµ‹è¯•**
   - [ ] ä¸º OCR å·¥ä½œæµæ·»åŠ æµ‹è¯•
   - [ ] ä¸ºæ•°æ®åŠ è½½æµç¨‹æ·»åŠ æµ‹è¯•
   - [ ] ä¸ºæœç´¢åŠŸèƒ½æ·»åŠ æµ‹è¯•

3. **æµ‹è¯•è´¨é‡æå‡**
   - [ ] å»ºç«‹æµ‹è¯•å®¡æŸ¥æµç¨‹
   - [ ] ä¼˜åŒ–æµ‹è¯•æ€§èƒ½
   - [ ] å®Œå–„æµ‹è¯•æ–‡æ¡£

#### ç¬¬å››é˜¶æ®µï¼šé«˜çº§æµ‹è¯•ï¼ˆ3-6ä¸ªæœˆï¼‰

**ç›®æ ‡**: å»ºç«‹å®Œæ•´çš„æµ‹è¯•ä½“ç³»

1. **E2E æµ‹è¯•**
   - [ ] å¼•å…¥ E2E æµ‹è¯•æ¡†æ¶
   - [ ] ä¸ºä¸»è¦æµç¨‹ç¼–å†™æµ‹è¯•

2. **æ€§èƒ½æµ‹è¯•**
   - [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
   - [ ] å»ºç«‹æ€§èƒ½åŸºå‡†

3. **æµ‹è¯•æœ€ä½³å®è·µ**
   - [ ] å»ºç«‹æµ‹è¯•æ–‡åŒ–
   - [ ] å®Œå–„æµ‹è¯•æ–‡æ¡£
   - [ ] å®šæœŸæµ‹è¯•è´¨é‡è¯„ä¼°

---

## ğŸ“… å®æ–½è®¡åˆ’ / Implementation Plan

### æ—¶é—´çº¿ / Timeline

```
ç¬¬ 1-2 å‘¨:  ç´§æ€¥ä¿®å¤
  â”œâ”€ å‡çº§ Vitest å’Œä¾èµ–
  â”œâ”€ åˆ›å»ºæµ‹è¯• CI/CD
  â””â”€ å®Œå–„æµ‹è¯•é…ç½®

ç¬¬ 3-4 å‘¨:  æ ¸å¿ƒæµ‹è¯•è¡¥å……
  â”œâ”€ å·¥å…·å‡½æ•°æµ‹è¯•ï¼ˆ80%+ï¼‰
  â””â”€ ç»„ä»¶æµ‹è¯•å¼€å§‹ï¼ˆ3-5ä¸ªç»„ä»¶ï¼‰

ç¬¬ 5-8 å‘¨:  å…¨é¢æµ‹è¯•è¦†ç›–
  â”œâ”€ ç»„ä»¶æµ‹è¯•æ‰©å±•ï¼ˆæ‰€æœ‰ç»„ä»¶ï¼Œ70%+ï¼‰
  â””â”€ é›†æˆæµ‹è¯•è¡¥å……

ç¬¬ 9-12 å‘¨: æµ‹è¯•è´¨é‡æå‡
  â”œâ”€ æµ‹è¯•å®¡æŸ¥æµç¨‹
  â”œâ”€ æµ‹è¯•æ€§èƒ½ä¼˜åŒ–
  â””â”€ æµ‹è¯•æ–‡æ¡£å®Œå–„

ç¬¬ 13-24 å‘¨: é«˜çº§æµ‹è¯•
  â”œâ”€ E2E æµ‹è¯•
  â”œâ”€ æ€§èƒ½æµ‹è¯•
  â””â”€ æµ‹è¯•æœ€ä½³å®è·µ
```

### é‡Œç¨‹ç¢‘ / Milestones

- **M1 (ç¬¬2å‘¨)**: æµ‹è¯•æ¡†æ¶å‡çº§å®Œæˆï¼ŒCI/CD é›†æˆå®Œæˆ
- **M2 (ç¬¬4å‘¨)**: æ ¸å¿ƒå‡½æ•°æµ‹è¯•è¦†ç›–ç‡ >= 80%
- **M3 (ç¬¬8å‘¨)**: ç»„ä»¶æµ‹è¯•è¦†ç›–ç‡ >= 70%
- **M4 (ç¬¬12å‘¨)**: æ•´ä½“æµ‹è¯•è¦†ç›–ç‡ >= 50%
- **M5 (ç¬¬24å‘¨)**: æ•´ä½“æµ‹è¯•è¦†ç›–ç‡ >= 60%ï¼ŒE2E æµ‹è¯•å»ºç«‹

---

## âœ… æ”¹è¿›æ£€æŸ¥æ¸…å• / Improvement Checklist

### åŸºç¡€è®¾æ–½ / Infrastructure

- [ ] Vitest å‡çº§åˆ° 4.0+
- [ ] å®‰è£… `@testing-library/react`
- [ ] å®‰è£… `@testing-library/jest-dom`
- [ ] æ›´æ–° `vitest.config.ts` å¯ç”¨è¦†ç›–ç‡
- [ ] å®Œå–„ `test/setup.ts` é…ç½®
- [ ] æ›´æ–° `package.json` æµ‹è¯•è„šæœ¬

### CI/CD é›†æˆ / CI/CD Integration

- [ ] åˆ›å»º `.github/workflows/test.yml`
- [ ] é…ç½®æµ‹è¯•è‡ªåŠ¨è¿è¡Œ
- [ ] é…ç½®è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆ
- [ ] é›†æˆåˆ° PR æ£€æŸ¥æµç¨‹
- [ ] è®¾ç½®è¦†ç›–ç‡é˜ˆå€¼æ£€æŸ¥

### æµ‹è¯•è¦†ç›– / Test Coverage

- [ ] `utils/index.ts` æ‰€æœ‰å‡½æ•°æµ‹è¯•ï¼ˆ>= 80%ï¼‰
- [ ] æ ¸å¿ƒç»„ä»¶æµ‹è¯•ï¼ˆArticle, Layout, Navbarï¼‰
- [ ] æ‰€æœ‰ç»„ä»¶æµ‹è¯•ï¼ˆ>= 70%ï¼‰
- [ ] é›†æˆæµ‹è¯•è¡¥å……
- [ ] è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†æµ‹è¯•

### æµ‹è¯•è´¨é‡ / Test Quality

- [ ] å»ºç«‹æµ‹è¯•ç›®å½•ç»“æ„
- [ ] åˆ›å»ºæµ‹è¯• fixtures å’Œ mocks
- [ ] å»ºç«‹æµ‹è¯•å·¥å…·å‡½æ•°åº“
- [ ] ä¸ºè·³è¿‡çš„æµ‹è¯•æ·»åŠ  mock
- [ ] å»ºç«‹æµ‹è¯•å®¡æŸ¥æµç¨‹

### æ–‡æ¡£å’Œè§„èŒƒ / Documentation and Standards

- [ ] æ›´æ–°æµ‹è¯•æ–‡æ¡£
- [ ] å»ºç«‹æµ‹è¯•ç¼–å†™è§„èŒƒ
- [ ] åˆ›å»ºæµ‹è¯•ç¤ºä¾‹åº“
- [ ] ç¼–å†™æµ‹è¯•æœ€ä½³å®è·µæ–‡æ¡£

---

## ğŸ“š ç›¸å…³æ–‡æ¡£ / Related Documentation

- [å¼€å‘æŒ‡å— - æµ‹è¯•éƒ¨åˆ†](../docs/dev.md#æµ‹è¯•æŒ‡å—--testing-guide)
- [è´¡çŒ®æŒ‡å— - æµ‹è¯•éƒ¨åˆ†](../CONTRIBUTING.md#æµ‹è¯•æŒ‡å—--testing-guide)
- [Vitest å®˜æ–¹æ–‡æ¡£](https://vitest.dev/)
- [React Testing Library æ–‡æ¡£](https://testing-library.com/react)

---

## ğŸ”„ æ›´æ–°è®°å½• / Update History

- **2024-01-XX**: åˆå§‹ç‰ˆæœ¬ï¼Œè®°å½•å½“å‰æµ‹è¯•å·¥ç¨‹é—®é¢˜
- **2024-01-XX**: æ·»åŠ è¯¦ç»†æ”¹è¿›æ–¹æ¡ˆå’Œå®æ–½è®¡åˆ’

---

**æ³¨æ„**: æœ¬æ–‡æ¡£åº”å®šæœŸæ›´æ–°ï¼Œåæ˜ æµ‹è¯•å·¥ç¨‹çš„æ”¹è¿›è¿›åº¦å’Œæ–°çš„é—®é¢˜ã€‚

**Note**: This document should be updated regularly to reflect testing engineering improvements and new issues.

